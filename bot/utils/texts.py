"""
Централизованная система текстов для бота
Все тексты в одном месте для легкой локализации и редактирования
"""

from typing import Dict, Any

# ═══════════════════════════════════════════════════════════════════
# 🎨 ПРИВЕТСТВЕННЫЕ СООБЩЕНИЯ
# ═══════════════════════════════════════════════════════════════════

def get_welcome_text(first_name: str, balance: float, subscription_days: int) -> str:
    """
    Приветственное сообщение для /start
    Современный стиль с акцентом на визуал и пользу
    Тренды 2025-2026: чистота, минимализм, читаемость
    """
    separator = "━━━━━━━━━━━━━━━━━━━━"
    
    return f"""
<b>✨ Добро пожаловать, {first_name}!</b>

<blockquote expandable>🔐 <b>YoVPN</b> — современный VPN-сервис нового поколения

Быстрый, безопасный и надёжный доступ к свободному интернету 🌐</blockquote>

{separator}

💰 <b>Ваш баланс:</b> <code>{balance:.2f}₽</code>
📅 <b>Дней доступа:</b> <code>{subscription_days}</code>

{separator}

<b>🎯 Преимущества YoVPN:</b>

⚡ <b>Скорость</b> — до 1 Гбит/с
🛡️ <b>Защита</b> — AES-256 шифрование
🌍 <b>География</b> — серверы в 15+ странах
💎 <b>Цена</b> — всего 4₽ в день

{separator}

<i>👇 Выберите нужный раздел в меню</i>
""".strip()


def get_new_user_welcome_text(first_name: str) -> str:
    """
    Приветствие для нового пользователя после анимации
    Современный дизайн с акцентом на быстрый старт
    """
    separator = "━━━━━━━━━━━━━━━━━━━━"
    
    return f"""
<b>🎉 Поздравляем, {first_name}!</b>

<blockquote>Система успешно инициализирована ✅

Вы получили приветственный бонус <b>+15₽</b> 🎁</blockquote>

{separator}

💰 <b>Баланс:</b> <code>15.00₽</code>
📅 <b>Доступ:</b> <code>3 дня бесплатно</code>
🎁 <b>Бонус:</b> <code>зачислен</code>

{separator}

<b>🚀 Быстрый старт (3 шага):</b>

<b>1️⃣</b> Активируйте подписку
<b>2️⃣</b> Настройте VPN на устройстве  
<b>3️⃣</b> Наслаждайтесь свободным интернетом

{separator}

<i>💡 Нажмите на кнопку ниже для начала</i>
""".strip()


# ═══════════════════════════════════════════════════════════════════
# 📱 ГЛАВНОЕ МЕНЮ
# ═══════════════════════════════════════════════════════════════════

def get_main_menu_text(first_name: str, balance: float, subscription_days: int, subscription_active: bool) -> str:
    """
    Текст главного меню - современный дизайн 2025-2026
    Минималистичный, чистый, с акцентом на ключевую информацию
    """
    status_emoji = "✅" if subscription_active else "⏸️"
    status_text = "Активна" if subscription_active else "Не активна"
    
    # Градиентная линия для разделения (визуальный тренд 2025)
    separator = "━━━━━━━━━━━━━━━━━━━━"
    
    return f"""
<b>🧭 Главное меню</b>

<blockquote>Привет, {first_name}! Добро пожаловать в YoVPN 👋</blockquote>

{separator}

💰 <b>Баланс:</b> <code>{balance:.2f}₽</code>
📅 <b>Доступ:</b> <code>{subscription_days} дн.</code>
{status_emoji} <b>Статус:</b> <code>{status_text}</code>

{separator}

<i>💡 Выберите действие из меню ниже</i>
""".strip()


# ═══════════════════════════════════════════════════════════════════
# 📊 СТАТИСТИКА
# ═══════════════════════════════════════════════════════════════════

def get_stats_text(stats: Dict[str, Any]) -> str:
    """
    Текст статистики пользователя
    """
    balance = stats.get('balance', 0.0)
    total_payments = stats.get('total_payments', 0.0)
    referrals_count = stats.get('referrals_count', 0)
    created_at = stats.get('created_at', 'Неизвестно')
    user_id = stats.get('user_id', 0)
    
    # Форматируем дату
    if created_at != 'Неизвестно':
        created_at = created_at[:10]
    
    # Достижения
    achievements = []
    if total_payments > 0:
        achievements.append("🥇 Первый платеж")
    if total_payments > 100:
        achievements.append("💎 Постоянный клиент")
    if referrals_count > 5:
        achievements.append("👥 Мастер рефералов")
    if not achievements:
        achievements.append("🌱 Новичок")
    
    return f"""
<b>📊 Твоя статистика</b>

╭─ 💰 <b>Финансы</b> ─────────╮
│  Баланс: <code>{balance:.2f}₽</code>
│  Пополнено: <code>{total_payments:.2f}₽</code>
│  Дней доступа: <code>{int(balance / 4)}</code>
╰────────────────────╯

╭─ 👥 <b>Рефералы</b> ─────────╮
│  Приглашено: <code>{referrals_count}</code> чел.
│  Заработано: <code>{referrals_count * 20}₽</code>
│  Код: <code>ref_{user_id}</code>
╰────────────────────╯

╭─ 📅 <b>Аккаунт</b> ──────────╮
│  Регистрация: <code>{created_at}</code>
│  Статус: <code>Активен</code>
│  Уведомления: <code>Вкл</code>
╰────────────────────╯

<b>🎯 Достижения:</b>
{chr(10).join(f"  • {a}" for a in achievements)}
""".strip()


# ═══════════════════════════════════════════════════════════════════
# 🎁 РЕФЕРАЛЫ
# ═══════════════════════════════════════════════════════════════════

def get_referrals_text(referrals_count: int, referral_code: str, referral_link: str) -> str:
    """
    Текст реферальной программы
    """
    return f"""
<b>🎁 Реферальная программа</b>

<b>💰 Зарабатывай с друзьями!</b>

╭─ 📊 <b>Твоя статистика</b> ──╮
│  Приглашено: <code>{referrals_count}</code> чел.
│  Заработано: <code>{referrals_count * 20}₽</code>
│  Код: <code>{referral_code}</code>
╰────────────────────╯

<b>🔗 Твоя ссылка:</b>
<code>{referral_link}</code>

<b>💡 Как это работает:</b>
1️⃣ Поделись ссылкой с другом
2️⃣ Друг регистрируется по ней
3️⃣ Ты получаешь <b>20₽</b> на баланс
4️⃣ Друг получает <b>20₽</b> бонус

<b>📋 Правила:</b>
• Бонус после первой оплаты друга
• Макс. 100 рефералов/месяц
• Автоматическое начисление
• Без фейковых аккаунтов

<i>Приглашай друзей и зарабатывай!</i> 🚀
""".strip()


# ═══════════════════════════════════════════════════════════════════
# ⚙️ НАСТРОЙКИ
# ═══════════════════════════════════════════════════════════════════

def get_settings_text() -> str:
    """
    Текст настроек
    """
    return f"""
<b>⚙️ Настройки</b>

Управляй своим аккаунтом и уведомлениями

╭─ 🔔 <b>Уведомления</b> ──────╮
│  Баланс: <code>Вкл</code>
│  Подписка: <code>Вкл</code>
│  Акции: <code>Вкл</code>
╰────────────────────╯

╭─ 🔄 <b>Автопродление</b> ────╮
│  Статус: <code>Выкл</code>
│  Мин. баланс: <code>40₽</code>
╰────────────────────╯

<i>Настрой бота под себя</i> 👇
""".strip()


# ═══════════════════════════════════════════════════════════════════
# 🆘 ПОДДЕРЖКА
# ═══════════════════════════════════════════════════════════════════

def get_support_text() -> str:
    """
    Текст поддержки
    """
    return f"""
<b>🆘 Служба поддержки</b>

Мы всегда на связи! 💬

╭─ 📞 <b>Контакты</b> ─────────╮
│  Telegram: <code>@YoVPNSupport</code>
│  Email: <code>support@yovpn.ru</code>
│  Время: <code>24/7</code>
╰────────────────────╯

<b>❓ Частые вопросы:</b>
• Как настроить VPN?
• Как пополнить баланс?
• Что делать при ошибке?
• Как работают рефералы?

<b>⏱️ Среднее время ответа:</b>
• В рабочие часы: <code>5-15 мин</code>
• Ночью: <code>30-60 мин</code>

<i>Напиши нам в любое время!</i> 💙
""".strip()


# ═══════════════════════════════════════════════════════════════════
# 🔄 АНИМАЦИЯ ЗАГРУЗКИ
# ═══════════════════════════════════════════════════════════════════

LOADING_ANIMATION_STEPS = [
    {
        "text": "🔄 <b>Инициализация системы...</b>",
        "delay": 0.8
    },
    {
        "text": "🔐 <b>Настройка шифрования...</b>\n\n███▒▒▒▒▒▒▒ 30%",
        "delay": 0.9
    },
    {
        "text": "🌐 <b>Подключение к серверам...</b>\n\n██████▒▒▒▒ 60%",
        "delay": 0.9
    },
    {
        "text": "🛡️ <b>Активация защиты...</b>\n\n█████████▒ 90%",
        "delay": 0.8
    },
    {
        "text": "✅ <b>Система готова к работе!</b>\n\n██████████ 100%",
        "delay": 1.0
    }
]


def get_loading_step(step: int) -> Dict[str, Any]:
    """
    Получить шаг анимации загрузки
    
    Args:
        step: Номер шага (0-4)
    
    Returns:
        Dict с текстом и задержкой
    """
    if 0 <= step < len(LOADING_ANIMATION_STEPS):
        return LOADING_ANIMATION_STEPS[step]
    return {"text": "", "delay": 0}


# ═══════════════════════════════════════════════════════════════════
# 💳 ПОДПИСКИ
# ═══════════════════════════════════════════════════════════════════

def get_subscriptions_text(has_active: bool, days_left: int = 0) -> str:
    """
    Текст раздела подписок
    """
    if has_active:
        return f"""
<b>📱 Мои подписки</b>

╭─ 🟢 <b>Активная подписка</b> ─╮
│  Осталось: <code>{days_left} дн.</code>
│  Цена: <code>4₽/день</code>
│  Статус: <code>Активна</code>
╰────────────────────╯

<b>🔗 Управление:</b>
• Скопировать конфигурацию
• Показать QR-код
• Инструкция по настройке

<i>Выбери действие ниже</i> 👇
""".strip()
    else:
        return f"""
<b>📱 Мои подписки</b>

╭─ ⚪ <b>Подписка неактивна</b> ─╮
│  Статус: <code>Не активна</code>
│  Доступно: <code>—</code>
╰────────────────────╯

<b>💎 Активируй подписку:</b>
• Всего <code>4₽</code> в день
• Безлимитный трафик
• Высокая скорость
• Полная анонимность

<i>Активируй прямо сейчас!</i> 👇
""".strip()


# ═══════════════════════════════════════════════════════════════════
# 💰 ПОПОЛНЕНИЕ БАЛАНСА
# ═══════════════════════════════════════════════════════════════════

def get_topup_text() -> str:
    """
    Текст пополнения баланса
    """
    return f"""
<b>💎 Пополнение баланса</b>

Выбери сумму или введи свою 👇

╭─ 💡 <b>Популярные пакеты</b> ─╮
│  🥉 40₽ = 10 дней
│  🥈 80₽ = 20 дней
│  🥇 120₽ = 30 дней (ХИТ!)
│  💎 200₽ = 50 дней
│  👑 400₽ = 100 дней
╰────────────────────╯

<b>✨ Преимущества:</b>
• Мгновенное зачисление
• Безопасная оплата
• Любые способы
• Без комиссий

<i>Выбери сумму ниже</i> 👇
""".strip()


# ═══════════════════════════════════════════════════════════════════
# 🎯 ФУНКЦИИ-ПОМОЩНИКИ
# ═══════════════════════════════════════════════════════════════════

def format_balance(balance: float) -> str:
    """Форматирует баланс"""
    return f"{balance:.2f}₽"


def format_days(days: int) -> str:
    """Форматирует дни с правильным склонением"""
    if days % 10 == 1 and days % 100 != 11:
        return f"{days} день"
    elif days % 10 in [2, 3, 4] and days % 100 not in [12, 13, 14]:
        return f"{days} дня"
    else:
        return f"{days} дней"
