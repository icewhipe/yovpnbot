"""
–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏—è–º–∏ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –∏ FAQ
"""

import logging
from aiogram import Dispatcher
from aiogram.types import CallbackQuery, Message
from aiogram import F

from assets.emojis.interface import EMOJI

logger = logging.getLogger(__name__)

async def handle_support(callback: CallbackQuery, **kwargs):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ü–æ–¥–¥–µ—Ä–∂–∫–∞"
    
    –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ–Ω—é –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ FAQ
    –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    """
    user_id = callback.from_user.id
    first_name = callback.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    username = callback.from_user.username or "–Ω–µ—Ç username"
    
    try:
        message_text = f"""
üÜò <b>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ YoVPN</b>

<blockquote>–ú—ã –≤—Å–µ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å –≤–∞–º —Å –ª—é–±—ã–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏!</blockquote>

üìû <b>–°–ø–æ—Å–æ–±—ã —Å–≤—è–∑–∏:</b>
‚îú üí¨ <b>Telegram:</b> @YoVPNSupport
‚îú üìß <b>Email:</b> support@yovpn.com
‚îî üåê <b>–°–∞–π—Ç:</b> https://yovpn.com/support

‚è∞ <b>–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏:</b>
‚îú <i>–ü–Ω-–ü—Ç:</i> <code>09:00 - 21:00</code>
‚îú <i>–°–±-–í—Å:</i> <code>10:00 - 18:00</code>
‚îî <i>–≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞:</i> <code>24/7</code>

üîç <b>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã:</b>
‚Ä¢ –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å VPN –Ω–∞ –º–æ—ë–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ?
‚Ä¢ –ö–∞–∫ –ø–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å?
‚Ä¢ –ü–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ?
‚Ä¢ –ö–∞–∫ –æ—Ç–º–µ–Ω–∏—Ç—å –∏–ª–∏ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É?

üìã <b>–ü—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ —É–∫–∞–∂–∏—Ç–µ:</b>
‚îú <b>–í–∞—à ID:</b> <code>{user_id}</code>
‚îú <b>–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã</b>
‚îú <b>–°–∫—Ä–∏–Ω—à–æ—Ç—ã</b> (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)
‚îî <b>–í—Ä–µ–º—è –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è</b>

<i>üí° –°–æ–≤–µ—Ç: –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª FAQ - –≤–æ–∑–º–æ–∂–Ω–æ, –≤–∞—à –≤–æ–ø—Ä–æ—Å —É–∂–µ —Ä–µ—à—ë–Ω!</i>
        """
        
        from bot.services.ui_service import UIService
        ui_service = UIService()
        
        # –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –ø–æ–¥–¥–µ—Ä–∂–∫–∏
        keyboard = ui_service.create_navigation_keyboard([
            {
                'text': f"{EMOJI['info']} FAQ",
                'callback_data': 'faq'
            },
            {
                'text': f"{EMOJI['message']} –ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É",
                'callback_data': 'contact_support'
            },
            {
                'text': f"{EMOJI['back']} –ù–∞–∑–∞–¥",
                'callback_data': 'main_menu'
            }
        ])
        
        await callback.message.edit_text(
            message_text,
            reply_markup=keyboard
        )
        
        await callback.answer()
        logger.info(f"üÜò –ü–æ–∫–∞–∑–∞–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id}")
        
    except Exception as e:
        logger.error(f"‚ùå –û—à–∏–±–∫–∞ –≤ handle_support: {e}")
        await callback.answer("‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞", show_alert=True)

async def handle_faq(callback: CallbackQuery):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ FAQ
    
    –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —á–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
    """
    try:
        message_text = f"""
‚ùì <b>–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã (FAQ)</b>

<blockquote>–ó–¥–µ—Å—å —Å–æ–±—Ä–∞–Ω—ã –æ—Ç–≤–µ—Ç—ã –Ω–∞ —Å–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞—à–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</blockquote>

üîß <b>–ù–ê–°–¢–†–û–ô–ö–ê VPN</b>

<b>Q:</b> <i>–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å VPN –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ Android?</i>
<b>A:</b> 
‚îú 1. –°–∫–∞—á–∞–π—Ç–µ <b>V2rayNG</b> –∏–∑ Google Play
‚îú 2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ –±–æ—Ç–∞
‚îú 3. –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –Ω–∞–∂–º–∏—Ç–µ <code>+</code> ‚Üí <code>–ò–º–ø–æ—Ä—Ç –∏–∑ –±—É—Ñ–µ—Ä–∞</code>
‚îî 4. –ù–∞–∂–º–∏—Ç–µ <code>–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è</code> ‚úÖ

<b>Q:</b> <i>–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å VPN –Ω–∞ iPhone/iPad?</i>
<b>A:</b> 
‚îú 1. –°–∫–∞—á–∞–π—Ç–µ <b>Streisand</b> –∏–∑ App Store
‚îú 2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ –±–æ—Ç–∞
‚îú 3. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
‚îî 4. –ù–∞–∂–º–∏—Ç–µ <code>–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è</code> ‚úÖ

<b>Q:</b> <i>–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å VPN –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ?</i>
<b>A:</b>
<b>Windows:</b> –°–∫–∞—á–∞–π—Ç–µ V2rayN ‚Üí –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é ‚Üí –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å
<b>macOS:</b> –°–∫–∞—á–∞–π—Ç–µ V2rayU ‚Üí –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é ‚Üí –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å
<b>Linux:</b> –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ v2ray-core ‚Üí –°–æ–∑–¥–∞–π—Ç–µ config.json ‚Üí –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª—É–∂–±—É

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üí∞ <b>–ü–õ–ê–¢–ï–ñ–ò –ò –ë–ê–õ–ê–ù–°</b>

<b>Q:</b> <i>–ö–∞–∫ –ø–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å?</i>
<b>A:</b> –ù–∞–∂–º–∏—Ç–µ <code>üí≥ –ü–æ–ø–æ–ª–Ω–∏—Ç—å</code> –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é ‚Üí –í—ã–±–µ—Ä–∏—Ç–µ —Å—É–º–º—É ‚Üí –í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã

<b>Q:</b> <i>–°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç –ø–æ–¥–ø–∏—Å–∫–∞?</i>
<b>A:</b> <b>4 —Ä—É–±–ª—è –≤ –¥–µ–Ω—å</b> üí∞
–°–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ <code>00:00 –ú–°–ö</code>

<b>Q:</b> <i>–ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –∑–∞–∫–æ–Ω—á–∞—Ç—Å—è –¥–µ–Ω—å–≥–∏ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ?</i>
<b>A:</b> –ü–æ–¥–ø–∏—Å–∫–∞ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚è∏Ô∏è
–ü–æ—Å–ª–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –æ–Ω–∞ –≤–æ–∑–æ–±–Ω–æ–≤–∏—Ç—Å—è —Å—Ä–∞–∑—É –∂–µ! üîÑ

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üîí <b>–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨</b>

<b>Q:</b> <i>–ë–µ–∑–æ–ø–∞—Å–µ–Ω –ª–∏ –≤–∞—à VPN?</i>
<b>A:</b> <b>–î–∞!</b> ‚úÖ
‚îú üîê –°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ <code>AES-256</code>
‚îú üö´ –ë–µ–∑ –ª–æ–≥–æ–≤ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (<code>No-logs policy</code>)
‚îî üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç —É—Ç–µ—á–µ–∫ DNS

<b>Q:</b> <i>–ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö?</i>
<b>A:</b> <b>–î–∞!</b> –û–¥–Ω—É –ø–æ–¥–ø–∏—Å–∫—É –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ <b>–Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º</b> –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ üì±üíª

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üîÑ <b>–¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –í–û–ü–†–û–°–´</b>

<b>Q:</b> <i>–ü–æ—á–µ–º—É –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ?</i>
<b>A:</b> –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
‚îú 1. –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ üì∂
‚îú 2. –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ ‚öôÔ∏è
‚îú 3. –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è üîÑ
‚îî 4. –î–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –±–∞–ª–∞–Ω—Å üí∞

<b>Q:</b> <i>–ö–∞–∫ –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É?</i>
<b>A:</b> –ü—Ä–æ—Å—Ç–æ –Ω–µ –ø–æ–ø–æ–ª–Ω—è–π—Ç–µ –±–∞–ª–∞–Ω—Å. –ü–æ–¥–ø–∏—Å–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–∏ <code>0 ‚ÇΩ</code>

<i>üí° –ù–µ –Ω–∞—à–ª–∏ –æ—Ç–≤–µ—Ç? –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É!</i>
        """
        
        from bot.services.ui_service import UIService
        ui_service = UIService()
        keyboard = ui_service.create_back_keyboard("support")
        
        await callback.message.edit_text(
            message_text,
            reply_markup=keyboard
        )
        
        await callback.answer()
        logger.info(f"‚ùì –ü–æ–∫–∞–∑–∞–Ω FAQ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {callback.from_user.id}")
        
    except Exception as e:
        logger.error(f"‚ùå –û—à–∏–±–∫–∞ –≤ handle_faq: {e}")
        await callback.answer("‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞", show_alert=True)

async def handle_contact_support(callback: CallbackQuery, **kwargs):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ–±—Ä–∞—â–µ–Ω–∏—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É
    
    –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è —Å–≤—è–∑–∏ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω—É
    """
    try:
        user_id = callback.from_user.id
        first_name = callback.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
        username = callback.from_user.username
        
        # –ü–æ–ª—É—á–∞–µ–º —Å–µ—Ä–≤–∏—Å—ã –∏–∑ middleware
        services = kwargs.get("services")
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
        ADMIN_ID = 7610842643
        try:
            if services:
                notification_service = services.get_notification_service()
                await notification_service.send_notification(
                    ADMIN_ID,
                    f"üÜò <b>–û–±—Ä–∞—â–µ–Ω–∏–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É</b>\n\n"
                    f"üë§ <b>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</b> {first_name}\n"
                    f"üÜî <b>ID:</b> <code>{user_id}</code>\n"
                    f"üì± <b>Username:</b> @{username if username else '–Ω–µ—Ç'}\n"
                    f"‚è∞ <b>–í—Ä–µ–º—è:</b> {services.get_ui_service().get_current_time()}"
                )
        except Exception as e:
            logger.warning(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω—É: {e}")
        
        message_text = f"""
üí¨ <b>–°–≤—è–∑—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π</b>

<blockquote>–ü—Ä–∏–≤–µ—Ç, {first_name}! –ú—ã –≥–æ—Ç–æ–≤—ã –ø–æ–º–æ—á—å –≤–∞–º 24/7 üåü</blockquote>

üìû <b>–ë—ã—Å—Ç—Ä–∞—è —Å–≤—è–∑—å:</b>
‚îú üí¨ <b>Telegram:</b> @YoVPNSupport
‚îî üìß <b>Email:</b> support@yovpn.com

üìã <b>–ü—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∂–∏—Ç–µ:</b>
‚îú üÜî <b>–í–∞—à ID:</b> <code>{user_id}</code>
‚îú üìù <b>–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã</b> (–ø–æ–¥—Ä–æ–±–Ω–æ)
‚îú üì∏ <b>–°–∫—Ä–∏–Ω—à–æ—Ç—ã</b> (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)
‚îî ‚è∞ <b>–í—Ä–µ–º—è –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è</b>

‚è±Ô∏è <b>–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞:</b>
‚îú ‚úâÔ∏è <i>–û–±—ã—á–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã:</i> <code>–¥–æ 2 —á–∞—Å–æ–≤</code>
‚îú üîß <i>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:</i> <code>–¥–æ 6 —á–∞—Å–æ–≤</code>
‚îî üö® <i>–≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ —Å–ª—É—á–∞–∏:</i> <code>–¥–æ 30 –º–∏–Ω—É—Ç</code>

üí° <b>–°–æ–≤–µ—Ç—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è:</b>
‚Ä¢ –û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ
‚Ä¢ –ü—Ä–∏–ª–æ–∂–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –æ—à–∏–±–æ–∫
‚Ä¢ –£–∫–∞–∂–∏—Ç–µ –º–æ–¥–µ–ª—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –≤–µ—Ä—Å–∏—é –û–°
‚Ä¢ –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤–∞—à ID: <code>{user_id}</code>

üÜò <b>–≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞:</b>
<blockquote expandable>–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ <b>–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è</b> (–ø–æ–ª–Ω–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ—Å—Ç—É–ø–∞, –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–ª–∞—Ç–µ–∂–æ–º –∏ —Ç.–¥.), 
–Ω–∞–ø–∏—à–∏—Ç–µ —Å–ª–æ–≤–æ <code>–°–†–û–ß–ù–û</code> –≤ –Ω–∞—á–∞–ª–µ –≤–∞—à–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è, –∏ –º—ã –æ—Ç–≤–µ—Ç–∏–º –≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ!</blockquote>

<i>‚úÖ –í–∞—à–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —É–≤–µ–¥–æ–º–ª—ë–Ω!</i>
        """
        
        from bot.services.ui_service import UIService
        ui_service = UIService()
        keyboard = ui_service.create_back_keyboard("support")
        
        await callback.message.edit_text(
            message_text,
            reply_markup=keyboard
        )
        
        await callback.answer()
        logger.info(f"üí¨ –ü–æ–∫–∞–∑–∞–Ω—ã –∫–æ–Ω—Ç–∞–∫—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id}")
        
    except Exception as e:
        logger.error(f"‚ùå –û—à–∏–±–∫–∞ –≤ handle_contact_support: {e}")
        await callback.answer("‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞", show_alert=True)

async def handle_support_message(message: Message, **kwargs):
    """
    –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É
    
    –ü–µ—Ä–µ—Å—ã–ª–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
    """
    user_id = message.from_user.id
    first_name = message.from_user.first_name or "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
    username = message.from_user.username
    
    # –ü–æ–ª—É—á–∞–µ–º —Å–µ—Ä–≤–∏—Å—ã
    services = kwargs.get("services")
    ADMIN_ID = 7610842643
    
    try:
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
        if services:
            notification_service = services.get_notification_service()
            await notification_service.send_notification(
                ADMIN_ID,
                f"üí¨ <b>–°–æ–æ–±—â–µ–Ω–∏–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É</b>\n\n"
                f"üë§ <b>–û—Ç:</b> {first_name} (@{username if username else '–Ω–µ—Ç'})\n"
                f"üÜî <b>ID:</b> <code>{user_id}</code>\n\n"
                f"<blockquote>{message.text}</blockquote>\n\n"
                f"‚è∞ <b>–í—Ä–µ–º—è:</b> {services.get_ui_service().get_current_time()}"
            )
            
            await message.reply(
                f"‚úÖ <b>–í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É!</b>\n\n"
                f"–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ–ª—É—á–∏—Ç –≤–∞—à–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∏ —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.\n\n"
                f"<i>–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: 2-6 —á–∞—Å–æ–≤</i>"
            )
            logger.info(f"üì® –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_id} –ø–µ—Ä–µ—Å–ª–∞–Ω–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É")
        else:
            await message.reply("‚ùå –°–µ—Ä–≤–∏—Å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.")
            
    except Exception as e:
        logger.error(f"‚ùå –û—à–∏–±–∫–∞ –ø–µ—Ä–µ—Å—ã–ª–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É: {e}")
        await message.reply("‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.")

def register_support_handler(dp: Dispatcher):
    """
    –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
    
    Args:
        dp: –î–∏—Å–ø–µ—Ç—á–µ—Ä –±–æ—Ç–∞
    """
    dp.callback_query.register(handle_support, F.data == "support")
    dp.callback_query.register(handle_faq, F.data == "faq")
    dp.callback_query.register(handle_contact_support, F.data == "contact_support")
    
    logger.info("‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã")