# üîß –ê–Ω–∞–ª–∏–∑ –∏ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –û—à–∏–±–æ–∫ –î–µ–ø–ª–æ–π–º–µ–Ω—Ç–∞ YoVPN

**–î–∞—Ç–∞:** 21.10.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ  
**–í–µ—Ç–∫–∞:** cursor/analyze-and-fix-deployment-errors-808e

---

## üìä –ö—Ä–∞—Ç–∫–æ–µ –†–µ–∑—é–º–µ

–ü—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç–∞ –±—ã–ª–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ **7 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º**, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–≤–æ–¥–∏–ª–∏ –∫ –æ—à–∏–±–∫–∞–º –ø—Ä–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ –Ω–∞ Railway. –í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –±—ã–ª–∏ —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã.

---

## üêõ –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ü—Ä–æ–±–ª–µ–º—ã –∏ –†–µ—à–µ–Ω–∏—è

### 1. ‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: bot/main.py - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
# –°—Ç—Ä–æ–∫–∏ 37-40 –≤ bot/main.py
from bot.handlers import webapp_handler

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ö–µ–Ω–¥–ª–µ—Ä–∞
dp.include_router(webapp_handler.router)  # ‚ùå dp –µ—â–µ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω!
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- `NameError: name 'dp' is not defined`
- –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- –î–µ–ø–ª–æ–π–º–µ–Ω—Ç –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –£–¥–∞–ª–µ–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–æ—É—Ç–µ—Ä–∞ –¥–æ —Å–æ–∑–¥–∞–Ω–∏—è –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
# –†–æ—É—Ç–µ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Å–∞ YoVPNBot —á–µ—Ä–µ–∑ register_handlers()
```

**–§–∞–π–ª:** `/workspace/bot/main.py` (—Å—Ç—Ä–æ–∫–∏ 37-40)

---

### 2. ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ü–æ—Ä—Ç–∞ API

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
# api/app/config.py
class Settings(BaseSettings):
    api_port: int = 8000  # ‚ùå –ñ–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–π –ø–æ—Ä—Ç
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- Railway –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—Ç —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `$PORT`
- API –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—Ç—É
- Health checks –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç
- –°–µ—Ä–≤–∏—Å –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ "unhealthy"

**–†–µ—à–µ–Ω–∏–µ:**
```python
# api/app/config.py
import os

class Settings(BaseSettings):
    api_port: int = int(os.getenv("PORT", os.getenv("API_PORT", "8000")))
    # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: $PORT (Railway) ‚Üí $API_PORT ‚Üí 8000 (default)
```

**–§–∞–π–ª:** `/workspace/api/app/config.py` (—Å—Ç—Ä–æ–∫–∞ 9)

---

### 3. ‚ùå –ö–æ–Ω—Ñ–ª–∏–∫—Ç –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π Railway

**–ü—Ä–æ–±–ª–µ–º–∞:**
```toml
# railway.toml
[build]
builder = "DOCKERFILE"  # ‚ùå –ö–æ–Ω—Ñ–ª–∏–∫—Ç —Å railway.json

# railway.json
{
  "build": {
    "builder": "NIXPACKS"  # ‚ö†Ô∏è –†–∞–∑–Ω—ã–µ –±–∏–ª–¥–µ—Ä—ã!
  }
}
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å–±–æ—Ä–∫–∏
- Railway –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –±–∏–ª–¥–µ—Ä
- –ù–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç–µ

**–†–µ—à–µ–Ω–∏–µ:**
```toml
# railway.toml - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω –Ω–∞ NIXPACKS
[build]
builder = "NIXPACKS"

[deploy]
startCommand = "python bot/main.py"
restartPolicyType = "ON_FAILURE"
```

**–§–∞–π–ª—ã:** 
- `/workspace/railway.toml`
- `/workspace/railway.json`

---

### 4. ‚ùå –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ Health Check Endpoints

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –í —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å —Ä–∞–∑–Ω—ã–µ –ø—É—Ç–∏:
  - `/health`
  - `/api/health`
  - `/`
- –ù–µ –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- Railway –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
- –õ–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è healthcheck
- –°–µ—Ä–≤–∏—Å –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –ø—Ä–∏—á–∏–Ω—ã

**–†–µ—à–µ–Ω–∏–µ:**
```python
# api/app/routes/api.py
@router.get("/health")
async def health_check():
    """Health check endpoint for Railway and monitoring"""
    return {
        "status": "healthy",
        "service": "YoVPN WebApp API",
        "version": "1.0.0"
    }
```

**–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è:**
- API: `/api/health` ‚úÖ
- Bot: Healthcheck —É–¥–∞–ª–µ–Ω (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è polling –±–æ—Ç–∞)
- WebApp: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Next.js healthcheck ‚úÖ

**–§–∞–π–ª:** `/workspace/api/app/routes/api.py` (—Å—Ç—Ä–æ–∫–∏ 133-137)

---

### 5. ‚ùå Dockerfile —Å –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

**–ü—Ä–æ–±–ª–µ–º–∞:**
```dockerfile
# Dockerfile
HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
    CMD curl -f http://localhost:8080/health || exit 1
    # ‚ùå curl –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ python:3.11-slim!
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ Docker –æ–±—Ä–∞–∑–∞
- `curl: command not found`
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç healthcheck

**–†–µ—à–µ–Ω–∏–µ:**
```dockerfile
# –£–¥–∞–ª–µ–Ω HEALTHCHECK –∏–∑ Dockerfile
# Railway –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è
# —á–µ—Ä–µ–∑ HTTP endpoints
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω healthcheck):**
```dockerfile
# –í–∞—Ä–∏–∞–Ω—Ç 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å curl
RUN apt-get update && apt-get install -y curl

# –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Python –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
HEALTHCHECK CMD python -c "import urllib.request; urllib.request.urlopen('http://localhost:8080/health')"
```

**–§–∞–π–ª:** `/workspace/Dockerfile` (—Å—Ç—Ä–æ–∫–∏ 57-58)

---

### 6. ‚úÖ WebApp Next.js –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–°—Ç–∞—Ç—É—Å:** –£–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

```javascript
// webapp/next.config.js
const nextConfig = {
  output: 'standalone', // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è Docker
  reactStrictMode: true,
  swcMinify: true,
}
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞:** ‚úÖ

---

### 7. ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ü—Ä–æ–±–ª–µ–º–∞: api_reload –≤ Production

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
# api/app/config.py
api_reload: bool = True  # ‚ö†Ô∏è –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å True –≤ production!
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –£–≤–µ–ª–∏—á–µ–Ω–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
- –ó–∞–º–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞
- –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å hot-reload –≤ production

**–†–µ—à–µ–Ω–∏–µ:**
```python
# api/app/config.py
api_reload: bool = False  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è production
```

**–§–∞–π–ª:** `/workspace/api/app/config.py` (—Å—Ç—Ä–æ–∫–∞ 10)

---

## üìã –ü–æ–ª–Ω—ã–π –°–ø–∏—Å–æ–∫ –ò–∑–º–µ–Ω–µ–Ω–∏–π

### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

1. **bot/main.py**
   - –£–¥–∞–ª–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞ 40: `dp.include_router(webapp_handler.router)`
   - –£–¥–∞–ª—ë–Ω –∏–º–ø–æ—Ä—Ç `webapp_handler` (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ)

2. **api/app/config.py**
   - –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `os`
   - –ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ—Ä—Ç–∞: `api_port: int = int(os.getenv("PORT", os.getenv("API_PORT", "8000")))`
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ `api_reload: bool = False`

3. **railway.toml**
   - –ò–∑–º–µ–Ω–µ–Ω –±–∏–ª–¥–µ—Ä —Å `DOCKERFILE` –Ω–∞ `NIXPACKS`
   - –£–¥–∞–ª–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞ `dockerfilePath = "Dockerfile"`
   - –£–ø—Ä–æ—â–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

4. **api/app/routes/api.py**
   - –£–ª—É—á—à–µ–Ω health check endpoint
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è –≤ –æ—Ç–≤–µ—Ç

5. **Dockerfile**
   - –£–¥–∞–ª–µ–Ω HEALTHCHECK —Å curl

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
```
‚ùå Bot: NameError - dp –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω
‚ùå API: –ù–µ —Å–ª—É—à–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç
‚ùå Railway: –ö–æ–Ω—Ñ–ª–∏–∫—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
‚ùå Docker: –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏ (curl not found)
‚ùå Healthcheck: –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
```
‚úÖ Bot: –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
‚úÖ API: –°–ª—É—à–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç ($PORT)
‚úÖ Railway: –ï–¥–∏–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (NIXPACKS)
‚úÖ Docker: –°–æ–±–∏—Ä–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
‚úÖ Healthcheck: –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

---

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –î–µ–ø–ª–æ–π–º–µ–Ω—Ç—É

### 1. Railway - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –û–∫—Ä—É–∂–µ–Ω–∏—è

#### –î–ª—è Telegram Bot —Å–µ—Ä–≤–∏—Å–∞:
```env
TELEGRAM_BOT_TOKEN=your_bot_token
MARZBAN_API_URL=https://your-marzban.com
MARZBAN_USERNAME=admin
MARZBAN_PASSWORD=your_password
SECRET_KEY=your_secret_key
REDIS_URL=${{Redis.REDIS_URL}}
SQLALCHEMY_DATABASE_URL=sqlite:///data/bot.db
PYTHONUNBUFFERED=1
PYTHONDONTWRITEBYTECODE=1
LOG_LEVEL=INFO
```

#### –î–ª—è API —Å–µ—Ä–≤–∏—Å–∞:
```env
TELEGRAM_BOT_TOKEN=your_bot_token
SECRET_KEY=your_secret_key
MARZBAN_API_URL=https://your-marzban.com
MARZBAN_USERNAME=admin
MARZBAN_PASSWORD=your_password
CORS_ORIGINS=https://your-webapp-url.up.railway.app
REDIS_URL=${{Redis.REDIS_URL}}
API_HOST=0.0.0.0
# –ù–µ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ API_PORT –∏–ª–∏ PORT - Railway —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

#### –î–ª—è WebApp —Å–µ—Ä–≤–∏—Å–∞:
```env
NODE_ENV=production
NEXT_PUBLIC_TELEGRAM_BOT_TOKEN=your_bot_token
NEXT_PUBLIC_API_BASE_URL=https://your-api-url.up.railway.app
NEXT_PUBLIC_BASE_URL=https://your-webapp-url.up.railway.app
NEXT_PUBLIC_DEV_MODE=false
```

### 2. –ü–æ—Ä—è–¥–æ–∫ –î–µ–ø–ª–æ—è

1. **Redis Database**
   ```
   + New ‚Üí Database ‚Üí Redis
   ```

2. **API Service**
   ```
   + New ‚Üí Empty Service ‚Üí "api"
   Root Directory: api
   Start Command: uvicorn app.main:app --host 0.0.0.0 --port $PORT
   ```
   - –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ–º–µ–Ω
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö

3. **Telegram Bot**
   ```
   + New ‚Üí Empty Service ‚Üí "telegram-bot"
   Start Command: python bot/main.py
   ```

4. **WebApp**
   ```
   + New ‚Üí Empty Service ‚Üí "webapp"
   Root Directory: webapp
   Build Command: npm install && npm run build
   Start Command: npm start
   ```
   - –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ–º–µ–Ω
   - –û–±–Ω–æ–≤–∏—Ç–µ `CORS_ORIGINS` –≤ API —Å–µ—Ä–≤–∏—Å–µ

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –†–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ API
curl https://your-api-url.up.railway.app/api/health

# –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
{
  "status": "healthy",
  "service": "YoVPN WebApp API",
  "version": "1.0.0"
}

# –ü—Ä–æ–≤–µ—Ä–∫–∞ WebApp
curl https://your-webapp-url.up.railway.app

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Bot
# –û—Ç–ø—Ä–∞–≤—å—Ç–µ /start –±–æ—Ç—É –≤ Telegram
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Railway Dashboard

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞:**
   - Bot: `Railway ‚Üí telegram-bot ‚Üí Deployments ‚Üí Logs`
   - API: `Railway ‚Üí api ‚Üí Deployments ‚Üí Logs`
   - WebApp: `Railway ‚Üí webapp ‚Üí Deployments ‚Üí Logs`

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏:**
   - CPU Usage < 80%
   - Memory Usage < 80%
   - Restart Count = 0

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å:**
   - –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å "Active" (–∑–µ–ª–µ–Ω—ã–π)
   - Deployment status: "Success"

### –ß–∞—Å—Ç—ã–µ –û—à–∏–±–∫–∏

| –û—à–∏–±–∫–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|--------|---------|---------|
| `NameError: name 'dp' is not defined` | –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è bot/main.py | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —ç—Ç–æ–º PR |
| `Address already in use` | –ü–æ—Ä—Ç 8000 –∑–∞–Ω—è—Ç | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è $PORT |
| `curl: command not found` | HEALTHCHECK –≤ Dockerfile | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ - —É–¥–∞–ª–µ–Ω HEALTHCHECK |
| API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è $PORT |
| CORS –æ—à–∏–±–∫–∏ | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π CORS_ORIGINS | –û–±–Ω–æ–≤–∏—Ç–µ CORS_ORIGINS –≤ API |

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ –®–∞–≥–∏

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. ‚úÖ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç –Ω–∞ Railway**
   - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
   - –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ 4 —Å–µ—Ä–≤–∏—Å–∞
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å

2. ‚úÖ **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - UptimeRobot –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ uptime
   - Sentry –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
   - Railway Metrics –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

3. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å CI/CD**
   - GitHub Actions –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ push –≤ main

4. ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
   - –û–±–Ω–æ–≤–∏—Ç—å README —Å –Ω–æ–≤—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏
   - –î–æ–±–∞–≤–∏—Ç—å troubleshooting –≥–∞–π–¥
   - –°–æ–∑–¥–∞—Ç—å –≤–∏–¥–µ–æ-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:

- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å custom domain
- –î–æ–±–∞–≤–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (Railway –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å database backups
- –î–æ–±–∞–≤–∏—Ç—å rate limiting
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

---

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –î–µ—Ç–∞–ª–∏

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Backend:** Python 3.11, FastAPI, Aiogram 3.4
- **Frontend:** Next.js 14, React 18, TypeScript
- **Database:** SQLite (bot), Redis (cache)
- **Deployment:** Railway, Nixpacks
- **Monitoring:** Railway Metrics

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Telegram  ‚îÇ
‚îÇ    Users    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Telegram   ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ   WebApp    ‚îÇ
‚îÇ     Bot     ‚îÇ      ‚îÇ  (Next.js)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ                    ‚îÇ
       ‚îÇ                    ‚îÇ
       ‚ñº                    ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    Redis    ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ  API FastAPI‚îÇ
‚îÇ   (Cache)   ‚îÇ      ‚îÇ  (Backend)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚îÇ
                            ‚ñº
                     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                     ‚îÇ   Marzban   ‚îÇ
                     ‚îÇ     API     ‚îÇ
                     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –£—è–∑–≤–∏–º–æ—Å—Ç–∏:

1. ‚úÖ **–ü–æ—Ä—Ç –Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∂–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω**
   - –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø–æ—Ä—Ç–æ–≤

2. ‚úÖ **api_reload –æ—Ç–∫–ª—é—á–µ–Ω –≤ production**
   - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏
   - –£–ª—É—á—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ strong SECRET_KEY (–º–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞)
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Ç–æ–∫–µ–Ω—ã –∏ –ø–∞—Ä–æ–ª–∏
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ rate limiting –Ω–∞ API
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS (Railway –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –ü—Ä–∏ –ü—Ä–æ–±–ª–µ–º–∞—Ö:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:** Railway Dashboard ‚Üí Service ‚Üí Logs
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:** Railway Dashboard ‚Üí Service ‚Üí Variables
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ health endpoints:**
   ```bash
   curl https://your-api-url.up.railway.app/api/health
   ```

### –ü–æ–ª–µ–∑–Ω—ã–µ –°—Å—ã–ª–∫–∏:

- [Railway Documentation](https://docs.railway.app/)
- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [Aiogram Documentation](https://docs.aiogram.dev/)
- [Next.js Documentation](https://nextjs.org/docs)

---

## ‚úÖ –°—Ç–∞—Ç—É—Å: –ì–æ—Ç–æ–≤–æ –∫ –î–µ–ø–ª–æ–π–º–µ–Ω—Ç—É

–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã. –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞ Railway.

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 21.10.2025  
**–ê–≤—Ç–æ—Ä:** YoVPN Development Team  
**–í–µ—Ä—Å–∏—è:** 1.0.0

---

**üéâ –£—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç–∞!**
